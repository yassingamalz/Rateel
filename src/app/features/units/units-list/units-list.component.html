<!-- units-list.component.html -->
<div class="units-page" dir="rtl">
  <header class="units-header">
    <div class="header-content">
      <h1 class="page-title">وحدات المقرر</h1>
      <button class="change-course-btn" routerLink="/courses">
        <i class="fas fa-exchange-alt"></i>
        تغيير المقرر
      </button>
    </div>
  </header>

  <div class="units-container"
       #unitsContainer
       [class.dragging]="isDragging"
       (mousedown)="onMouseDown($event)"
       (mousemove)="onMouseMove($event)"
       (mouseup)="onMouseUp()"
       (mouseleave)="onMouseLeave()"
       (touchstart)="onTouchStart($event)"
       (touchmove)="onTouchMove($event)"
       (touchend)="onTouchEnd()">
    <div class="units-wrapper">
      <ng-container *ngFor="let unit of units$ | async; let i = index">
        <div class="unit-item">
          <app-unit-card
            [unit]="unit"
            [isActive]="activeUnitId === unit.id"
            (unitSelected)="onUnitSelected($event)">
          </app-unit-card>

          <!-- Connector Line -->
          <div class="connector-line" *ngIf="i < (units$ | async)!.length - 1">
            <div class="connector-line__progress" 
                 [style.width.%]="getConnectorProgress(unit, (units$ | async)![i + 1])">
            </div>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>