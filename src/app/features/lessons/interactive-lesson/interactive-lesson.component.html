<!-- interactive-lesson.component.html -->
<div class="practice-container">
  <!-- Verses Container with Horizontal Scroll -->
  <div class="verses-container" 
       #versesContainer
       [class.dragging]="isDragging"
       (mousedown)="onMouseDown($event)"
       (mousemove)="onMouseMove($event)"
       (mouseup)="onMouseUp()"
       (mouseleave)="onMouseLeave()"
       (touchstart)="onTouchStart($event)"
       (touchmove)="onTouchMove($event)"
       (touchend)="onTouchEnd()">

    <div class="verses-wrapper"
         [style.transform]="'translateX(' + state.scrollPosition + 'px)'"
         #versesWrapper>
      <ng-container *ngFor="let verse of verses; let i = index">
        <div class="verse-card"
             [class.active]="i === state.currentVerseIndex"
             [class.completed]="isVerseCompleted(i)">
          <!-- Verse Content -->
          <div class="verse-frame">
            <!-- Verse Number -->
            <div class="verse-number">{{i + 1}}</div>

            <!-- Verse Text with Tajweed Highlights -->
            <div class="verse-text" [innerHTML]="getHighlightedText(verse)"></div>

            <!-- Progress Dots -->
            <div class="verse-progress" *ngIf="isVerseActive(i)">
              <div class="progress-dots">
                <span class="dot">
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Connector Line -->
        <div class="connector-line" *ngIf="i < verses.length - 1"
             [class.completed]="isVerseCompleted(i)">
        </div>
      </ng-container>
    </div>
  </div>

  <!-- Recording Button -->
  <div class="recording-controls">
    <button class="record-button"
            [class.recording]="state.isRecording"
            [disabled]="state.isCompleted"
            (click)="toggleRecording()">
      <i class="fas" 
         [class.fa-microphone]="!state.isRecording"
         [class.fa-stop]="state.isRecording">
      </i>
      <div class="record-ripple" *ngIf="state.isRecording"></div>
    </button>
  </div>

  <!-- Feedback Dialog -->
  <div class="feedback-dialog" *ngIf="state.feedback" [@feedbackAnimation]>
    <div class="feedback-content" [class.success]="state.feedback === 'أحسنت!'">
      <i class="fas" 
         [class.fa-check-circle]="state.feedback === 'أحسنت!'"
         [class.fa-times-circle]="state.feedback !== 'أحسنت!'">
      </i>
      <span>{{state.feedback}}</span>
    </div>
  </div>
</div>